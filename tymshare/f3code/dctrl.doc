TTYPE (file) DCTRL.DOC
THIS FILE IS DCTRL.DOC --- DESCRIPTION OF DISK CONTROLLER

DISK CONTROLLER OPCODES   I.E. PDP-10 I/O INSTRUCTION CODES
=======================
715     READ CMD
716     READ MA
717     READ DA
720     READ ECC
721     LOAD CMD
722     LOAD MA
723     LOAD DA
724     LOAD ECC

LOAD ECC
========
PRIMARILY CLEARS ERROR CORRECTING CODE LOGIC.
ALSO, DOES SPECIAL FUNCTION DEPENDING ON CONTENTS OF E.

CONTENTS OF E   FUNCTION
-------------   --------
        1       START A COMMAND
        2       INITIALIZE CONTROLLER   (SEND BEFORE STARTING CMD)


LOAD DA, READ DA
================
LOAD AND READ DISK ADDRESS. SELECT UNIT.

BITS    CONTENTS
----    --------
04-06   UNIT NUMBER
07      SELECT UNIT
                THIS BIT MUST BE CLEARED, THEN SET, TO SELECT UNIT
08-19   CYLINDER NUMBER
20-27   HEAD NUMBER
28-35   SECTOR NUMBER

^L
DETAIL FOR LOAD CMD:
BIT #   FUNCTION
=====   ========
15      USE SECTOR COUNTER
                FOR ROTATIONAL POSITION SENSING - TELLS CONTROLLER
                TO LISTEN TO SIGNALS FROM DRIVE TO TELL WHERE IT IS.
16      RELEASE
                RELEASE DRIVE FOR USE BY ANOTHER COMPUTER
17      RECALIBRATE
                SIDE EFFECT: RESETS SEEK ERROR
---------
18      FAULT CLEAR
                SIDE EFFECT: RESETS SEL UNIT FAULT
                USE BITS 17,18 WITH COMMAND=4
19      DATA STROBE LATE
20      DATA STROBE EARLY
---
21      SERVO OFFSET MINUS
22      SERVO OFFSET PLUS
                BITS 15-22 ARE 0 BY DEFAULT
                BITS 19-22 ARE FOR READING MARGINAL DATA
23      CMD FROM MEMORY
                COMMAND SENDS DATA FROM MEMORY TO DISK
                (USE WITH WRITE COMMANDS)
---
24      CMD 0
25      CMD 1
26      CMD 2
                BITS 24-26 ARE DISK CONTROLLER SEQUENCER START ADDRESS
------
27      32 BIT MODE
28      ***
29      ***
---
30      ANY ATTENTION INTERRUPT ENABLE
                ALLOWS INTERRUPT WHEN ANY UNIT IS AT ATTENTION
31      ***
32      DONE INTERRUPT ENABLE
---
33      ***
34      ***
35      ***

DETAIL FOR CMD (BITS 24-26)
        CMD     FN
        ---     --
        0       READ
        1       WRITE
        3       WRITE ALL               (SECTOR + FORMAT DATA)
        4       CONTROL FUNCTIONS       (RECAL, FAULT CLEAR)
        5       (WILL BE 'SEEK')
^L
DETAIL FOR READ CMD:
BIT #   FUNCTION
=====   ========
00      SELECT ERROR
                IF 0, SUCCESSFULLY TALKING TO A DISK UNIT
                IF 1, BITS 01-06 NOT VALID.
01      SEL UNIT WRITE PROTECTED
02      -SEL UNIT READY
                -READY LIGHT ON DRIVE
---
03      SEL UNIT ON CYLINDER
                SEEK COMPLETE
04      SEL UNIT SEEK ERROR
                DETECTED BY DRIVE
05      SEL UNIT FAULT
                DETECTED BY DRIVE
---
06      SEL UNIT ATTENTION
                SET BY LEADING EDGE OF BIT 03  (ON CYL)
07      HEADER COMPARE ERROR
                SECTOR COUNTER /= SECTOR HEADER
                (FOR USE WITH ROTATIONAL POSITION SENSING)
08      NOT BUSY
                DISK CONTROLLER SEQUENCER IS STOPPED
09      FIFO EMPTY -- SHOULD BE ON AFTER NORMAL READ OR WRITE
------
10      ***
11      READ OVERRUN ERROR
---
12      WRITE OVERRUN ERROR
13      SECTOR OVERRUN ERROR
14      INTERNAL PARITY ERROR
                BITS 11-14 ARE DETECTED BY CONTROLLER
---
15-17   (SAME AS LOAD CMD)
---------
18-20   (SAME AS LOAD CMD)
---
21-23   (SAME AS LOAD CMD)
---
24-26   (SAME AS LOAD CMD)
------
27      (SAME AS LOAD CMD)
28      ANY ERROR
                OR OF ALL ERROR BITS EXCEPT 14 (INTERNAL PARITY)
29      ANY ATTENTION
                AY UNIT IS AT ATTENTION
---
30      (SAME AS LOAD CMD)
31      -ACTIVE
                SEQUENCER STOPPED AND FIFO EMPTY (ON INPUT TO MEMORY)
32      (SAME AS LOAD CMD)
---
33      READ COMPARE ERROR
                CONTROLLER COMPARES MEMORY TO DISK (NOT IMPLEMENTED)
34      TIMOUT ERROR
                *** NOT IMPLEMENTED ***
35      MEM PAR ERR
^L
BYTE PACKING BY HARDWARE:
        1ST 4 BYTES GO TO (OR COME FROM) WORD N, BITS 0-31. NEXT BYTE
        GETS SPLIT 4 BITS TO WORD N, BITS 32-35, AND 4 BITS TO WORD N+1,
        BITS 32-35. LAST 4 BYTES TO WORD N+1, BITS 0-31.

32 BIT MODE:    DATA TAKEN FROM HIGH ORDER 4 BYTES ONLY.



@LOGOFF  ?
@LOGOUT 
Logout Job 7, User POOLE, Acct WIZARD, TTY 13, at  5/30/80 1618
  Used 0:0:9 in 0:1:28
